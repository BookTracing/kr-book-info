/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __create = Object.create;
var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __getProtoOf = Object.getPrototypeOf;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __markAsModule = (target) => __defProp(target, "__esModule", { value: true });
var __export = (target, all) => {
  __markAsModule(target);
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __reExport = (target, module2, desc) => {
  if (module2 && typeof module2 === "object" || typeof module2 === "function") {
    for (let key of __getOwnPropNames(module2))
      if (!__hasOwnProp.call(target, key) && key !== "default")
        __defProp(target, key, { get: () => module2[key], enumerable: !(desc = __getOwnPropDesc(module2, key)) || desc.enumerable });
  }
  return target;
};
var __toModule = (module2) => {
  return __reExport(__markAsModule(__defProp(module2 != null ? __create(__getProtoOf(module2)) : {}, "default", module2 && module2.__esModule && "default" in module2 ? { get: () => module2.default, enumerable: true } : { value: module2, enumerable: true })), module2);
};
var __async = (__this, __arguments, generator) => {
  return new Promise((resolve, reject) => {
    var fulfilled = (value) => {
      try {
        step(generator.next(value));
      } catch (e) {
        reject(e);
      }
    };
    var rejected = (value) => {
      try {
        step(generator.throw(value));
      } catch (e) {
        reject(e);
      }
    };
    var step = (x) => x.done ? resolve(x.value) : Promise.resolve(x.value).then(fulfilled, rejected);
    step((generator = generator.apply(__this, __arguments)).next());
  });
};

// main.ts
__export(exports, {
  default: () => KrBookInfo
});
var import_obsidian2 = __toModule(require("obsidian"));

// src/crawler.ts
var import_obsidian = __toModule(require("obsidian"));
var searchBookUrl = (keyword) => __async(void 0, null, function* () {
  keyword = encodeURI(keyword);
  try {
    const response = yield (0, import_obsidian.requestUrl)({
      url: "http://www.yes24.com/Product/Search?domain=BOOK&query=" + keyword
    });
    const parser = new DOMParser();
    const html = parser.parseFromString(response.text, "text/html");
    const bookUrl = html.querySelector("#yesSchList > li:nth-child(1) > div > div.item_info > div.info_row.info_name > a.gd_name").getAttribute("href");
    return bookUrl;
  } catch (err) {
    return "";
  }
});
var totalSearchBookUrl = (keyword) => __async(void 0, null, function* () {
  keyword = encodeURI(keyword);
  try {
    const response = yield (0, import_obsidian.requestUrl)({
      url: "http://www.yes24.com/Product/Search?domain=ALL&query=" + keyword
    });
    const parser = new DOMParser();
    const html = parser.parseFromString(response.text, "text/html");
    const bookUrl = html.querySelector("#yesSchList > li:nth-child(1) > div > div.item_info > div.info_row.info_name > a.gd_name").getAttribute("href");
    return bookUrl;
  } catch (err) {
    return "";
  }
});
var getBookUrl = (keyword) => __async(void 0, null, function* () {
  let bookUrl = yield searchBookUrl(keyword);
  if (!bookUrl)
    bookUrl = yield totalSearchBookUrl(keyword);
  return bookUrl;
});
var getBookInfoResult = (bookUrl) => __async(void 0, null, function* () {
  bookUrl = encodeURI(bookUrl);
  try {
    const response = yield (0, import_obsidian.requestUrl)({
      url: `http://www.yes24.com` + bookUrl
    });
    const parser = new DOMParser();
    const html = parser.parseFromString(response.text, "text/html");
    const tags = [];
    html.querySelectorAll("#infoset_goodsCate > div.infoSetCont_wrap > dl:nth-child(1) > dd > ul > li > a").forEach((value) => {
      tags.push(value.getText().replace(/(\s*)/g, ""));
    });
    const tag = [...new Set(tags)];
    let title = html.querySelector("#yDetailTopWrap > div.topColRgt > div.gd_infoTop > div > h2").getText().replace(/\(.*\)/gi, "").replace(/\[.*\]/gi, "").replace(":", "\uFF1A").replace("?", "\uFF1F").trim();
    const subTitle = html.querySelector("#yDetailTopWrap > div.topColRgt > div.gd_infoTop > div > h3").getText().replace(":", "\uFF1A").replace("?", "\uFF1F").trim();
    if (subTitle) {
      title = title + "\uFF1A" + subTitle;
    }
    const author = [];
    html.querySelectorAll("#yDetailTopWrap > div.topColRgt > div.gd_infoTop > span.gd_pubArea > span.gd_auth").forEach((value) => {
      author.push(value.getText().trim());
    });
    let page = +html.querySelector("#infoset_specific > div.infoSetCont_wrap > div > table > tbody > tr:nth-child(2) > td").getText().split(" ")[0].slice(0, -1);
    if (isNaN(page))
      page = 0;
    const publishDate = html.querySelector("#yDetailTopWrap > div.topColRgt > div.gd_infoTop > span.gd_pubArea > span.gd_date").getText().split(" ").map((v) => v.slice(0, -1)).join("-");
    const coverUrl = html.querySelector("#yDetailTopWrap > div.topColLft > div > span > em > img").getAttribute("src");
    const frontmatter = {
      created: `${new Date(+new Date() + 3240 * 1e4).toISOString().split("T")[0] + " " + new Date().toTimeString().split(" ")[0].slice(0, 5)}`,
      tag: `\u{1F4DA}\uB3C5\uC11C ${tag.join(" ")}`,
      title: `${title}`,
      author: `${author.join(", ")}`,
      category: `${tag[1]}`,
      total_page: page,
      publish_date: `${publishDate}`,
      cover_url: `${coverUrl}`,
      status: `\u{1F7E9} \uC644\uB8CC`,
      start_read_date: `${new Date(+new Date() + 3240 * 1e4).toISOString().split("T")[0]}`,
      finish_read_date: `${new Date(+new Date() + 3240 * 1e4).toISOString().split("T")[0]}`,
      my_rate: 0,
      book_note: `\u274C`
    };
    const result = `---
${(0, import_obsidian.stringifyYaml)(frontmatter)}---

# ${title}`;
    return [
      title.replace("\uFF1A", " ").replace("\uFF1F", "").replace("/", "\uFF0F").replace(/\s{2,}/gi, " "),
      result
    ];
  } catch (err) {
    return ["", ""];
  }
});
var getBook = (keyword) => __async(void 0, null, function* () {
  const bookUrl = yield getBookUrl(keyword);
  if (!bookUrl) {
    return [keyword, `${keyword} No title found`];
  }
  const [title, result] = yield getBookInfoResult(bookUrl);
  if (!result) {
    return [keyword, `${keyword} No title found`];
  }
  return [title, result];
});

// main.ts
var KrBookInfo = class extends import_obsidian2.Plugin {
  onload() {
    return __async(this, null, function* () {
      this.addRibbonIcon("lines-of-text", "Add Book Info", (evt) => __async(this, null, function* () {
        const file = this.app.workspace.getActiveFile();
        if (!file) {
          new import_obsidian2.Notice("There's no active file, Please open new file");
          return;
        }
        new import_obsidian2.Notice("Loading...");
        const [title, result] = yield getBook(file.basename);
        const text = yield this.app.vault.read(file);
        this.app.vault.modify(file, result + "\n\n" + text);
        const regExp = /[\{\}\[\]\/?.,;:|\)*~`!^\-+<>@\#$%&\\\=\(\'\"]/gi;
        const fileName = title.replace(regExp, "");
        this.app.fileManager.renameFile(this.app.vault.getAbstractFileByPath(file.path), file.parent.path + "/" + fileName + ".md");
        new import_obsidian2.Notice("Success!");
        return;
      }));
    });
  }
  onunload() {
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsibWFpbi50cyIsICJzcmMvY3Jhd2xlci50cyJdLAogICJzb3VyY2VzQ29udGVudCI6IFsiaW1wb3J0IHsgTm90aWNlLCBQbHVnaW4gfSBmcm9tIFwib2JzaWRpYW5cIjtcclxuaW1wb3J0IHsgZ2V0Qm9vayB9IGZyb20gXCJzcmMvY3Jhd2xlclwiO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgS3JCb29rSW5mbyBleHRlbmRzIFBsdWdpbiB7XHJcblx0YXN5bmMgb25sb2FkKCkge1xyXG5cdFx0Ly8gVGhpcyBjcmVhdGVzIGFuIGljb24gaW4gdGhlIGxlZnQgcmliYm9uLlxyXG5cdFx0dGhpcy5hZGRSaWJib25JY29uKFxyXG5cdFx0XHRcImxpbmVzLW9mLXRleHRcIixcclxuXHRcdFx0XCJBZGQgQm9vayBJbmZvXCIsXHJcblx0XHRcdGFzeW5jIChldnQ6IE1vdXNlRXZlbnQpID0+IHtcclxuXHRcdFx0XHQvLyBjaGVjayBjdXJyZW50IGFjdGl2ZSBmaWxlXHJcblx0XHRcdFx0Y29uc3QgZmlsZSA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVGaWxlKCk7XHJcblxyXG5cdFx0XHRcdGlmICghZmlsZSkge1xyXG5cdFx0XHRcdFx0bmV3IE5vdGljZShcIlRoZXJlJ3Mgbm8gYWN0aXZlIGZpbGUsIFBsZWFzZSBvcGVuIG5ldyBmaWxlXCIpO1xyXG5cdFx0XHRcdFx0cmV0dXJuO1xyXG5cdFx0XHRcdH1cclxuXHJcblx0XHRcdFx0Ly8gQ2FsbGVkIHdoZW4gdGhlIHVzZXIgY2xpY2tzIHRoZSBpY29uLlxyXG5cdFx0XHRcdG5ldyBOb3RpY2UoXCJMb2FkaW5nLi4uXCIpO1xyXG5cclxuXHRcdFx0XHQvLyBTZWFyY2ggYm9vayB0aHJvdWdoIGN1cnJlbnQgZmlsZSdzIHRpdGxlXHJcblx0XHRcdFx0Y29uc3QgW3RpdGxlLCByZXN1bHRdID0gYXdhaXQgZ2V0Qm9vayhmaWxlLmJhc2VuYW1lKTtcclxuXHJcblx0XHRcdFx0Ly8gY2hlY2sgZmlsZSdzIHRleHRcclxuXHRcdFx0XHRjb25zdCB0ZXh0ID0gYXdhaXQgdGhpcy5hcHAudmF1bHQucmVhZChmaWxlKTtcclxuXHJcblx0XHRcdFx0Ly8gam9pbiBGcm9udG1hdHRlciBBbmQgdGV4dFxyXG5cdFx0XHRcdHRoaXMuYXBwLnZhdWx0Lm1vZGlmeShmaWxlLCByZXN1bHQgKyBcIlxcblxcblwiICsgdGV4dCk7XHJcblxyXG5cdFx0XHRcdGNvbnN0IHJlZ0V4cCA9XHJcblx0XHRcdFx0XHQvW1xce1xcfVxcW1xcXVxcLz8uLDs6fFxcKSp+YCFeXFwtKzw+QFxcIyQlJlxcXFxcXD1cXChcXCdcXFwiXS9naTtcclxuXHJcblx0XHRcdFx0Ly8gc2FuaXRpemluZyB0aGUgdGl0bGVcclxuXHRcdFx0XHRjb25zdCBmaWxlTmFtZSA9IHRpdGxlLnJlcGxhY2UocmVnRXhwLCBcIlwiKTtcclxuXHJcblx0XHRcdFx0Ly8gY2hhbmdlIGZpbGUgbmFtZVxyXG5cdFx0XHRcdHRoaXMuYXBwLmZpbGVNYW5hZ2VyLnJlbmFtZUZpbGUoXHJcblx0XHRcdFx0XHR0aGlzLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgoZmlsZS5wYXRoKSxcclxuXHRcdFx0XHRcdGZpbGUucGFyZW50LnBhdGggKyBcIi9cIiArIGZpbGVOYW1lICsgXCIubWRcIlxyXG5cdFx0XHRcdCk7XHJcblxyXG5cdFx0XHRcdG5ldyBOb3RpY2UoXCJTdWNjZXNzIVwiKTtcclxuXHJcblx0XHRcdFx0cmV0dXJuO1xyXG5cdFx0XHR9XHJcblx0XHQpO1xyXG5cdH1cclxuXHJcblx0b251bmxvYWQoKSB7fVxyXG59XHJcbiIsICJpbXBvcnQgeyByZXF1ZXN0VXJsLCBzdHJpbmdpZnlZYW1sIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5cbi8vIHNlYXJjaCBrZXl3b3JkIGFuZCByZXR1cm4geWVzMjQgc2VhcmNoIHJlc3VsdCBmcm9tIFx1QUQ2RFx1QjBCNFx1QjNDNFx1QzExQ1xuY29uc3Qgc2VhcmNoQm9va1VybCA9IGFzeW5jIChrZXl3b3JkOiBzdHJpbmcpID0+IHtcblx0a2V5d29yZCA9IGVuY29kZVVSSShrZXl3b3JkKTtcblx0dHJ5IHtcblx0XHRjb25zdCByZXNwb25zZSA9IGF3YWl0IHJlcXVlc3RVcmwoe1xuXHRcdFx0dXJsOlxuXHRcdFx0XHRcImh0dHA6Ly93d3cueWVzMjQuY29tL1Byb2R1Y3QvU2VhcmNoP2RvbWFpbj1CT09LJnF1ZXJ5PVwiICtcblx0XHRcdFx0a2V5d29yZCxcblx0XHR9KTtcblxuXHRcdGNvbnN0IHBhcnNlciA9IG5ldyBET01QYXJzZXIoKTtcblx0XHRjb25zdCBodG1sID0gcGFyc2VyLnBhcnNlRnJvbVN0cmluZyhyZXNwb25zZS50ZXh0LCBcInRleHQvaHRtbFwiKTtcblxuXHRcdGNvbnN0IGJvb2tVcmwgPSBodG1sXG5cdFx0XHQucXVlcnlTZWxlY3Rvcihcblx0XHRcdFx0XCIjeWVzU2NoTGlzdCA+IGxpOm50aC1jaGlsZCgxKSA+IGRpdiA+IGRpdi5pdGVtX2luZm8gPiBkaXYuaW5mb19yb3cuaW5mb19uYW1lID4gYS5nZF9uYW1lXCJcblx0XHRcdClcblx0XHRcdC5nZXRBdHRyaWJ1dGUoXCJocmVmXCIpO1xuXG5cdFx0cmV0dXJuIGJvb2tVcmw7XG5cdH0gY2F0Y2ggKGVycikge1xuXHRcdHJldHVybiBcIlwiO1xuXHR9XG59O1xuXG4vLyBzZWFyY2gga2V5d29yZCBhbmQgcmV0dXJuIHllczI0IHNlYXJjaCByZXN1bHQgZnJvbSBcdUQxQjVcdUQ1NjlcdUFDODBcdUMwQzlcbmNvbnN0IHRvdGFsU2VhcmNoQm9va1VybCA9IGFzeW5jIChrZXl3b3JkOiBzdHJpbmcpID0+IHtcblx0a2V5d29yZCA9IGVuY29kZVVSSShrZXl3b3JkKTtcblx0dHJ5IHtcblx0XHRjb25zdCByZXNwb25zZSA9IGF3YWl0IHJlcXVlc3RVcmwoe1xuXHRcdFx0dXJsOlxuXHRcdFx0XHRcImh0dHA6Ly93d3cueWVzMjQuY29tL1Byb2R1Y3QvU2VhcmNoP2RvbWFpbj1BTEwmcXVlcnk9XCIgK1xuXHRcdFx0XHRrZXl3b3JkLFxuXHRcdH0pO1xuXG5cdFx0Y29uc3QgcGFyc2VyID0gbmV3IERPTVBhcnNlcigpO1xuXHRcdGNvbnN0IGh0bWwgPSBwYXJzZXIucGFyc2VGcm9tU3RyaW5nKHJlc3BvbnNlLnRleHQsIFwidGV4dC9odG1sXCIpO1xuXG5cdFx0Y29uc3QgYm9va1VybCA9IGh0bWxcblx0XHRcdC5xdWVyeVNlbGVjdG9yKFxuXHRcdFx0XHRcIiN5ZXNTY2hMaXN0ID4gbGk6bnRoLWNoaWxkKDEpID4gZGl2ID4gZGl2Lml0ZW1faW5mbyA+IGRpdi5pbmZvX3Jvdy5pbmZvX25hbWUgPiBhLmdkX25hbWVcIlxuXHRcdFx0KVxuXHRcdFx0LmdldEF0dHJpYnV0ZShcImhyZWZcIik7XG5cblx0XHRyZXR1cm4gYm9va1VybDtcblx0fSBjYXRjaCAoZXJyKSB7XG5cdFx0cmV0dXJuIFwiXCI7XG5cdH1cbn07XG5cbi8vIGdldCBib29rIHVybFxuLy8gaWYgbm90IHNlYXJjaGVkIGluIFx1QUQ2RFx1QjBCNFx1QjNDNFx1QzExQywgcmVzZWFyY2ggYXQgXHVEMUI1XHVENTY5XHVBQzgwXHVDMEM5IGFuZCByZXR1cm4gdXJsXG5jb25zdCBnZXRCb29rVXJsID0gYXN5bmMgKGtleXdvcmQ6IHN0cmluZykgPT4ge1xuXHRsZXQgYm9va1VybCA9IGF3YWl0IHNlYXJjaEJvb2tVcmwoa2V5d29yZCk7XG5cblx0aWYgKCFib29rVXJsKSBib29rVXJsID0gYXdhaXQgdG90YWxTZWFyY2hCb29rVXJsKGtleXdvcmQpO1xuXG5cdHJldHVybiBib29rVXJsO1xufTtcblxuLy8gZ290byBib29rIGluZm9cbi8vIGlmIGJvb2sgaGFzIHN1YiB0aXRsZSwgdGl0bGUgd2lsbCBiZSBtZXJnZWRcbi8vIGlmIHBhZ2UgaXMgbm90IG51bWJlciwgY29udmVydCBpbnRvIDBcbmNvbnN0IGdldEJvb2tJbmZvUmVzdWx0ID0gYXN5bmMgKGJvb2tVcmw6IHN0cmluZykgPT4ge1xuXHRib29rVXJsID0gZW5jb2RlVVJJKGJvb2tVcmwpO1xuXHR0cnkge1xuXHRcdGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgcmVxdWVzdFVybCh7XG5cdFx0XHR1cmw6IGBodHRwOi8vd3d3LnllczI0LmNvbWAgKyBib29rVXJsLFxuXHRcdH0pO1xuXG5cdFx0Y29uc3QgcGFyc2VyID0gbmV3IERPTVBhcnNlcigpO1xuXHRcdGNvbnN0IGh0bWwgPSBwYXJzZXIucGFyc2VGcm9tU3RyaW5nKHJlc3BvbnNlLnRleHQsIFwidGV4dC9odG1sXCIpO1xuXG5cdFx0Y29uc3QgdGFnczogc3RyaW5nW10gPSBbXTtcblxuXHRcdGh0bWwucXVlcnlTZWxlY3RvckFsbChcblx0XHRcdFwiI2luZm9zZXRfZ29vZHNDYXRlID4gZGl2LmluZm9TZXRDb250X3dyYXAgPiBkbDpudGgtY2hpbGQoMSkgPiBkZCA+IHVsID4gbGkgPiBhXCJcblx0XHQpLmZvckVhY2goKHZhbHVlKSA9PiB7XG5cdFx0XHR0YWdzLnB1c2godmFsdWUuZ2V0VGV4dCgpLnJlcGxhY2UoLyhcXHMqKS9nLCBcIlwiKSk7XG5cdFx0fSk7XG5cblx0XHRjb25zdCB0YWcgPSBbLi4ubmV3IFNldCh0YWdzKV07XG5cblx0XHRsZXQgdGl0bGUgPSBodG1sXG5cdFx0XHQucXVlcnlTZWxlY3Rvcihcblx0XHRcdFx0XCIjeURldGFpbFRvcFdyYXAgPiBkaXYudG9wQ29sUmd0ID4gZGl2LmdkX2luZm9Ub3AgPiBkaXYgPiBoMlwiXG5cdFx0XHQpXG5cdFx0XHQuZ2V0VGV4dCgpXG5cdFx0XHQucmVwbGFjZSgvXFwoLipcXCkvZ2ksIFwiXCIpXG5cdFx0XHQucmVwbGFjZSgvXFxbLipcXF0vZ2ksIFwiXCIpXG5cdFx0XHQucmVwbGFjZShcIjpcIiwgXCJcdUZGMUFcIilcblx0XHRcdC5yZXBsYWNlKFwiP1wiLCBcIlx1RkYxRlwiKVxuXHRcdFx0LnRyaW0oKTtcblxuXHRcdGNvbnN0IHN1YlRpdGxlID0gaHRtbFxuXHRcdFx0LnF1ZXJ5U2VsZWN0b3IoXG5cdFx0XHRcdFwiI3lEZXRhaWxUb3BXcmFwID4gZGl2LnRvcENvbFJndCA+IGRpdi5nZF9pbmZvVG9wID4gZGl2ID4gaDNcIlxuXHRcdFx0KVxuXHRcdFx0LmdldFRleHQoKVxuXHRcdFx0LnJlcGxhY2UoXCI6XCIsIFwiXHVGRjFBXCIpXG5cdFx0XHQucmVwbGFjZShcIj9cIiwgXCJcdUZGMUZcIilcblx0XHRcdC50cmltKCk7XG5cblx0XHRpZiAoc3ViVGl0bGUpIHtcblx0XHRcdHRpdGxlID0gdGl0bGUgKyBcIlx1RkYxQVwiICsgc3ViVGl0bGU7XG5cdFx0fVxuXG5cdFx0Y29uc3QgYXV0aG9yOiBzdHJpbmdbXSA9IFtdO1xuXG5cdFx0aHRtbC5xdWVyeVNlbGVjdG9yQWxsKFxuXHRcdFx0XCIjeURldGFpbFRvcFdyYXAgPiBkaXYudG9wQ29sUmd0ID4gZGl2LmdkX2luZm9Ub3AgPiBzcGFuLmdkX3B1YkFyZWEgPiBzcGFuLmdkX2F1dGhcIlxuXHRcdCkuZm9yRWFjaCgodmFsdWUpID0+IHtcblx0XHRcdGF1dGhvci5wdXNoKHZhbHVlLmdldFRleHQoKS50cmltKCkpO1xuXHRcdH0pO1xuXG5cdFx0bGV0IHBhZ2UgPSAraHRtbFxuXHRcdFx0LnF1ZXJ5U2VsZWN0b3IoXG5cdFx0XHRcdFwiI2luZm9zZXRfc3BlY2lmaWMgPiBkaXYuaW5mb1NldENvbnRfd3JhcCA+IGRpdiA+IHRhYmxlID4gdGJvZHkgPiB0cjpudGgtY2hpbGQoMikgPiB0ZFwiXG5cdFx0XHQpXG5cdFx0XHQuZ2V0VGV4dCgpXG5cdFx0XHQuc3BsaXQoXCIgXCIpWzBdXG5cdFx0XHQuc2xpY2UoMCwgLTEpO1xuXG5cdFx0aWYgKGlzTmFOKHBhZ2UpKSBwYWdlID0gMDtcblxuXHRcdGNvbnN0IHB1Ymxpc2hEYXRlID0gaHRtbFxuXHRcdFx0LnF1ZXJ5U2VsZWN0b3IoXG5cdFx0XHRcdFwiI3lEZXRhaWxUb3BXcmFwID4gZGl2LnRvcENvbFJndCA+IGRpdi5nZF9pbmZvVG9wID4gc3Bhbi5nZF9wdWJBcmVhID4gc3Bhbi5nZF9kYXRlXCJcblx0XHRcdClcblx0XHRcdC5nZXRUZXh0KClcblx0XHRcdC5zcGxpdChcIiBcIilcblx0XHRcdC5tYXAoKHYpID0+IHYuc2xpY2UoMCwgLTEpKVxuXHRcdFx0LmpvaW4oXCItXCIpO1xuXG5cdFx0Y29uc3QgY292ZXJVcmwgPSBodG1sXG5cdFx0XHQucXVlcnlTZWxlY3Rvcihcblx0XHRcdFx0XCIjeURldGFpbFRvcFdyYXAgPiBkaXYudG9wQ29sTGZ0ID4gZGl2ID4gc3BhbiA+IGVtID4gaW1nXCJcblx0XHRcdClcblx0XHRcdC5nZXRBdHRyaWJ1dGUoXCJzcmNcIik7XG5cblx0XHRjb25zdCBmcm9udG1hdHRlciA9IHtcblx0XHRcdGNyZWF0ZWQ6IGAke1xuXHRcdFx0XHRuZXcgRGF0ZSgrbmV3IERhdGUoKSArIDMyNDAgKiAxMDAwMClcblx0XHRcdFx0XHQudG9JU09TdHJpbmcoKVxuXHRcdFx0XHRcdC5zcGxpdChcIlRcIilbMF0gK1xuXHRcdFx0XHRcIiBcIiArXG5cdFx0XHRcdG5ldyBEYXRlKCkudG9UaW1lU3RyaW5nKCkuc3BsaXQoXCIgXCIpWzBdLnNsaWNlKDAsIDUpXG5cdFx0XHR9YCxcblx0XHRcdHRhZzogYFx1RDgzRFx1RENEQVx1QjNDNVx1QzExQyAke3RhZy5qb2luKFwiIFwiKX1gLFxuXHRcdFx0dGl0bGU6IGAke3RpdGxlfWAsXG5cdFx0XHRhdXRob3I6IGAke2F1dGhvci5qb2luKFwiLCBcIil9YCxcblx0XHRcdGNhdGVnb3J5OiBgJHt0YWdbMV19YCxcblx0XHRcdHRvdGFsX3BhZ2U6IHBhZ2UsXG5cdFx0XHRwdWJsaXNoX2RhdGU6IGAke3B1Ymxpc2hEYXRlfWAsXG5cdFx0XHRjb3Zlcl91cmw6IGAke2NvdmVyVXJsfWAsXG5cdFx0XHRzdGF0dXM6IGBcdUQ4M0RcdURGRTkgXHVDNjQ0XHVCOENDYCxcblx0XHRcdHN0YXJ0X3JlYWRfZGF0ZTogYCR7XG5cdFx0XHRcdG5ldyBEYXRlKCtuZXcgRGF0ZSgpICsgMzI0MCAqIDEwMDAwKS50b0lTT1N0cmluZygpLnNwbGl0KFwiVFwiKVswXVxuXHRcdFx0fWAsXG5cdFx0XHRmaW5pc2hfcmVhZF9kYXRlOiBgJHtcblx0XHRcdFx0bmV3IERhdGUoK25ldyBEYXRlKCkgKyAzMjQwICogMTAwMDApLnRvSVNPU3RyaW5nKCkuc3BsaXQoXCJUXCIpWzBdXG5cdFx0XHR9YCxcblx0XHRcdG15X3JhdGU6IDAsXG5cdFx0XHRib29rX25vdGU6IGBcdTI3NENgLFxuXHRcdH07XG5cblx0XHRjb25zdCByZXN1bHQgPSBgLS0tXG4ke3N0cmluZ2lmeVlhbWwoZnJvbnRtYXR0ZXIpfS0tLVxuXG4jICR7dGl0bGV9YDtcblxuXHRcdHJldHVybiBbXG5cdFx0XHR0aXRsZVxuXHRcdFx0XHQucmVwbGFjZShcIlx1RkYxQVwiLCBcIiBcIilcblx0XHRcdFx0LnJlcGxhY2UoXCJcdUZGMUZcIiwgXCJcIilcblx0XHRcdFx0LnJlcGxhY2UoXCIvXCIsIFwiXHVGRjBGXCIpXG5cdFx0XHRcdC5yZXBsYWNlKC9cXHN7Mix9L2dpLCBcIiBcIiksXG5cdFx0XHRyZXN1bHQsXG5cdFx0XTtcblx0fSBjYXRjaCAoZXJyKSB7XG5cdFx0cmV0dXJuIFtcIlwiLCBcIlwiXTtcblx0fVxufTtcblxuLy8gZ2V0IGJvb2sncyBpbmZvIGFuZCByZXR1cm4gZnJvbnRtYXR0ZXJcbmNvbnN0IGdldEJvb2sgPSBhc3luYyAoa2V5d29yZDogc3RyaW5nKSA9PiB7XG5cdGNvbnN0IGJvb2tVcmwgPSBhd2FpdCBnZXRCb29rVXJsKGtleXdvcmQpO1xuXG5cdGlmICghYm9va1VybCkge1xuXHRcdHJldHVybiBba2V5d29yZCwgYCR7a2V5d29yZH0gTm8gdGl0bGUgZm91bmRgXTtcblx0fVxuXG5cdGNvbnN0IFt0aXRsZSwgcmVzdWx0XSA9IGF3YWl0IGdldEJvb2tJbmZvUmVzdWx0KGJvb2tVcmwpO1xuXG5cdGlmICghcmVzdWx0KSB7XG5cdFx0cmV0dXJuIFtrZXl3b3JkLCBgJHtrZXl3b3JkfSBObyB0aXRsZSBmb3VuZGBdO1xuXHR9XG5cblx0cmV0dXJuIFt0aXRsZSwgcmVzdWx0XTtcbn07XG5cbmV4cG9ydCB7IGdldEJvb2sgfTtcbiJd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
