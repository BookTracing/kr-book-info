/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __create = Object.create;
var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __getProtoOf = Object.getPrototypeOf;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __markAsModule = (target) => __defProp(target, "__esModule", { value: true });
var __export = (target, all) => {
  __markAsModule(target);
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __reExport = (target, module2, desc) => {
  if (module2 && typeof module2 === "object" || typeof module2 === "function") {
    for (let key of __getOwnPropNames(module2))
      if (!__hasOwnProp.call(target, key) && key !== "default")
        __defProp(target, key, { get: () => module2[key], enumerable: !(desc = __getOwnPropDesc(module2, key)) || desc.enumerable });
  }
  return target;
};
var __toModule = (module2) => {
  return __reExport(__markAsModule(__defProp(module2 != null ? __create(__getProtoOf(module2)) : {}, "default", module2 && module2.__esModule && "default" in module2 ? { get: () => module2.default, enumerable: true } : { value: module2, enumerable: true })), module2);
};
var __async = (__this, __arguments, generator) => {
  return new Promise((resolve, reject) => {
    var fulfilled = (value) => {
      try {
        step(generator.next(value));
      } catch (e) {
        reject(e);
      }
    };
    var rejected = (value) => {
      try {
        step(generator.throw(value));
      } catch (e) {
        reject(e);
      }
    };
    var step = (x) => x.done ? resolve(x.value) : Promise.resolve(x.value).then(fulfilled, rejected);
    step((generator = generator.apply(__this, __arguments)).next());
  });
};

// main.ts
__export(exports, {
  default: () => KrBookInfo
});
var import_obsidian2 = __toModule(require("obsidian"));

// src/crawler.ts
var import_obsidian = __toModule(require("obsidian"));
var searchBookUrl = (keyword) => __async(void 0, null, function* () {
  keyword = encodeURI(keyword);
  try {
    const response = yield (0, import_obsidian.requestUrl)({
      url: "http://www.yes24.com/Product/Search?domain=BOOK&query=" + keyword
    });
    const parser = new DOMParser();
    const html = parser.parseFromString(response.text, "text/html");
    const bookUrl = html.querySelector("#yesSchList > li:nth-child(1) > div > div.item_info > div.info_row.info_name > a.gd_name").getAttribute("href");
    return bookUrl;
  } catch (err) {
    console.log(err);
    return "";
  }
});
var totalSearchBookUrl = (keyword) => __async(void 0, null, function* () {
  keyword = encodeURI(keyword);
  try {
    const response = yield (0, import_obsidian.requestUrl)({
      url: "http://www.yes24.com/Product/Search?domain=ALL&query=" + keyword
    });
    const parser = new DOMParser();
    const html = parser.parseFromString(response.text, "text/html");
    const bookUrl = html.querySelector("#yesSchList > li:nth-child(1) > div > div.item_info > div.info_row.info_name > a.gd_name").getAttribute("href");
    return bookUrl;
  } catch (err) {
    console.log(err);
    return "";
  }
});
var getBookUrl = (keyword) => __async(void 0, null, function* () {
  let bookUrl = yield searchBookUrl(keyword);
  if (!bookUrl)
    bookUrl = yield totalSearchBookUrl(keyword);
  return bookUrl;
});
var getBookInfoResult = (bookUrl) => __async(void 0, null, function* () {
  bookUrl = encodeURI(bookUrl);
  try {
    const response = yield (0, import_obsidian.requestUrl)({
      url: `http://www.yes24.com` + bookUrl
    });
    const parser = new DOMParser();
    const html = parser.parseFromString(response.text, "text/html");
    const tags = [];
    html.querySelectorAll("#infoset_goodsCate > div.infoSetCont_wrap > dl:nth-child(1) > dd > ul > li > a").forEach((value) => {
      tags.push(value.getText().replace(/(\s*)/g, ""));
    });
    const tag = [...new Set(tags)];
    let title = html.querySelector("#yDetailTopWrap > div.topColRgt > div.gd_infoTop > div > h2").getText().replace(/\(.*\)/gi, "").replace(/\[.*\]/gi, "").replace(":", "\uFF1A").replace("?", "\uFF1F").trim();
    let subTitle = html.querySelector("#yDetailTopWrap > div.topColRgt > div.gd_infoTop > div > h3");
    if (subTitle) {
      title = title + "\uFF1A" + subTitle.getText().replace(":", "\uFF1A").replace("?", "\uFF1F").trim();
    }
    const author = [];
    html.querySelectorAll("#yDetailTopWrap > div.topColRgt > div.gd_infoTop > span.gd_pubArea > span.gd_auth").forEach((value) => {
      author.push(value.getText().trim());
    });
    let page = +html.querySelector("#infoset_specific > div.infoSetCont_wrap > div > table > tbody > tr:nth-child(2) > td").getText().split(" ")[0].slice(0, -1);
    if (isNaN(page))
      page = 0;
    const publishDate = html.querySelector("#yDetailTopWrap > div.topColRgt > div.gd_infoTop > span.gd_pubArea > span.gd_date").getText().split(" ").map((v) => v.slice(0, -1)).join("-");
    const coverUrl = html.querySelector("#yDetailTopWrap > div.topColLft > div > span > em > img").getAttribute("src");
    const frontmatter = {
      created: `${new Date(+new Date() + 3240 * 1e4).toISOString().split("T")[0] + " " + new Date().toTimeString().split(" ")[0].slice(0, 5)}`,
      tag: `\u{1F4DA}\uB3C5\uC11C ${tag.join(" ")}`,
      title: `${title}`,
      author: `${author.join(", ")}`,
      category: `${tag[1]}`,
      total_page: page,
      publish_date: `${publishDate}`,
      cover_url: `${coverUrl}`,
      status: `\u{1F7E9} \uC644\uB8CC`,
      start_read_date: `${new Date(+new Date() + 3240 * 1e4).toISOString().split("T")[0]}`,
      finish_read_date: `${new Date(+new Date() + 3240 * 1e4).toISOString().split("T")[0]}`,
      my_rate: 0,
      book_note: `\u274C`
    };
    const result = `---
${(0, import_obsidian.stringifyYaml)(frontmatter)}---

# ${title}`;
    return [
      title.replace("\uFF1A", " ").replace("\uFF1F", "").replace("/", "\uFF0F").replace(/\s{2,}/gi, " "),
      result
    ];
  } catch (err) {
    console.log(err);
    return ["", ""];
  }
});
var getBook = (keyword) => __async(void 0, null, function* () {
  const bookUrl = yield getBookUrl(keyword);
  if (!bookUrl) {
    return [keyword, `${keyword} No title found`];
  }
  const [title, result] = yield getBookInfoResult(bookUrl);
  if (!result) {
    return [keyword, `${keyword} No title found`];
  }
  return [title, result];
});

// main.ts
var KrBookInfo = class extends import_obsidian2.Plugin {
  onload() {
    return __async(this, null, function* () {
      this.addRibbonIcon("lines-of-text", "Add Book Info", (evt) => __async(this, null, function* () {
        const file = this.app.workspace.getActiveFile();
        if (!file) {
          new import_obsidian2.Notice("There's no active file, Please open new file");
          return;
        }
        new import_obsidian2.Notice("Loading...");
        const [title, result] = yield getBook(file.basename);
        const text = yield this.app.vault.read(file);
        this.app.vault.modify(file, result + "\n\n" + text);
        const regExp = /[\{\}\[\]\/?.,;:|\)*~`!^\-+<>@\#$%&\\\=\(\'\"]/gi;
        const fileName = title.replace(regExp, "");
        this.app.fileManager.renameFile(this.app.vault.getAbstractFileByPath(file.path), file.parent.path + "/" + fileName + ".md");
        new import_obsidian2.Notice("Success!");
        return;
      }));
    });
  }
  onunload() {
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsibWFpbi50cyIsICJzcmMvY3Jhd2xlci50cyJdLAogICJzb3VyY2VzQ29udGVudCI6IFsiaW1wb3J0IHsgTm90aWNlLCBQbHVnaW4gfSBmcm9tIFwib2JzaWRpYW5cIjtcclxuaW1wb3J0IHsgZ2V0Qm9vayB9IGZyb20gXCJzcmMvY3Jhd2xlclwiO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgS3JCb29rSW5mbyBleHRlbmRzIFBsdWdpbiB7XHJcblx0YXN5bmMgb25sb2FkKCkge1xyXG5cdFx0Ly8gVGhpcyBjcmVhdGVzIGFuIGljb24gaW4gdGhlIGxlZnQgcmliYm9uLlxyXG5cdFx0dGhpcy5hZGRSaWJib25JY29uKFxyXG5cdFx0XHRcImxpbmVzLW9mLXRleHRcIixcclxuXHRcdFx0XCJBZGQgQm9vayBJbmZvXCIsXHJcblx0XHRcdGFzeW5jIChldnQ6IE1vdXNlRXZlbnQpID0+IHtcclxuXHRcdFx0XHQvLyBjaGVjayBjdXJyZW50IGFjdGl2ZSBmaWxlXHJcblx0XHRcdFx0Y29uc3QgZmlsZSA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVGaWxlKCk7XHJcblxyXG5cdFx0XHRcdGlmICghZmlsZSkge1xyXG5cdFx0XHRcdFx0bmV3IE5vdGljZShcIlRoZXJlJ3Mgbm8gYWN0aXZlIGZpbGUsIFBsZWFzZSBvcGVuIG5ldyBmaWxlXCIpO1xyXG5cdFx0XHRcdFx0cmV0dXJuO1xyXG5cdFx0XHRcdH1cclxuXHJcblx0XHRcdFx0Ly8gQ2FsbGVkIHdoZW4gdGhlIHVzZXIgY2xpY2tzIHRoZSBpY29uLlxyXG5cdFx0XHRcdG5ldyBOb3RpY2UoXCJMb2FkaW5nLi4uXCIpO1xyXG5cclxuXHRcdFx0XHQvLyBTZWFyY2ggYm9vayB0aHJvdWdoIGN1cnJlbnQgZmlsZSdzIHRpdGxlXHJcblx0XHRcdFx0Y29uc3QgW3RpdGxlLCByZXN1bHRdID0gYXdhaXQgZ2V0Qm9vayhmaWxlLmJhc2VuYW1lKTtcclxuXHJcblx0XHRcdFx0Ly8gY2hlY2sgZmlsZSdzIHRleHRcclxuXHRcdFx0XHRjb25zdCB0ZXh0ID0gYXdhaXQgdGhpcy5hcHAudmF1bHQucmVhZChmaWxlKTtcclxuXHJcblx0XHRcdFx0Ly8gam9pbiBGcm9udG1hdHRlciBBbmQgdGV4dFxyXG5cdFx0XHRcdHRoaXMuYXBwLnZhdWx0Lm1vZGlmeShmaWxlLCByZXN1bHQgKyBcIlxcblxcblwiICsgdGV4dCk7XHJcblxyXG5cdFx0XHRcdGNvbnN0IHJlZ0V4cCA9XHJcblx0XHRcdFx0XHQvW1xce1xcfVxcW1xcXVxcLz8uLDs6fFxcKSp+YCFeXFwtKzw+QFxcIyQlJlxcXFxcXD1cXChcXCdcXFwiXS9naTtcclxuXHJcblx0XHRcdFx0Ly8gc2FuaXRpemluZyB0aGUgdGl0bGVcclxuXHRcdFx0XHRjb25zdCBmaWxlTmFtZSA9IHRpdGxlLnJlcGxhY2UocmVnRXhwLCBcIlwiKTtcclxuXHJcblx0XHRcdFx0Ly8gY2hhbmdlIGZpbGUgbmFtZVxyXG5cdFx0XHRcdHRoaXMuYXBwLmZpbGVNYW5hZ2VyLnJlbmFtZUZpbGUoXHJcblx0XHRcdFx0XHR0aGlzLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgoZmlsZS5wYXRoKSxcclxuXHRcdFx0XHRcdGZpbGUucGFyZW50LnBhdGggKyBcIi9cIiArIGZpbGVOYW1lICsgXCIubWRcIlxyXG5cdFx0XHRcdCk7XHJcblxyXG5cdFx0XHRcdG5ldyBOb3RpY2UoXCJTdWNjZXNzIVwiKTtcclxuXHJcblx0XHRcdFx0cmV0dXJuO1xyXG5cdFx0XHR9XHJcblx0XHQpO1xyXG5cdH1cclxuXHJcblx0b251bmxvYWQoKSB7fVxyXG59XHJcbiIsICJpbXBvcnQgeyByZXF1ZXN0VXJsLCBzdHJpbmdpZnlZYW1sIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5cbi8vIHNlYXJjaCBrZXl3b3JkIGFuZCByZXR1cm4geWVzMjQgc2VhcmNoIHJlc3VsdCBmcm9tIFx1QUQ2RFx1QjBCNFx1QjNDNFx1QzExQ1xuY29uc3Qgc2VhcmNoQm9va1VybCA9IGFzeW5jIChrZXl3b3JkOiBzdHJpbmcpID0+IHtcblx0a2V5d29yZCA9IGVuY29kZVVSSShrZXl3b3JkKTtcblx0dHJ5IHtcblx0XHRjb25zdCByZXNwb25zZSA9IGF3YWl0IHJlcXVlc3RVcmwoe1xuXHRcdFx0dXJsOlxuXHRcdFx0XHRcImh0dHA6Ly93d3cueWVzMjQuY29tL1Byb2R1Y3QvU2VhcmNoP2RvbWFpbj1CT09LJnF1ZXJ5PVwiICtcblx0XHRcdFx0a2V5d29yZCxcblx0XHR9KTtcblxuXHRcdGNvbnN0IHBhcnNlciA9IG5ldyBET01QYXJzZXIoKTtcblx0XHRjb25zdCBodG1sID0gcGFyc2VyLnBhcnNlRnJvbVN0cmluZyhyZXNwb25zZS50ZXh0LCBcInRleHQvaHRtbFwiKTtcblxuXHRcdGNvbnN0IGJvb2tVcmwgPSBodG1sXG5cdFx0XHQucXVlcnlTZWxlY3Rvcihcblx0XHRcdFx0XCIjeWVzU2NoTGlzdCA+IGxpOm50aC1jaGlsZCgxKSA+IGRpdiA+IGRpdi5pdGVtX2luZm8gPiBkaXYuaW5mb19yb3cuaW5mb19uYW1lID4gYS5nZF9uYW1lXCJcblx0XHRcdClcblx0XHRcdC5nZXRBdHRyaWJ1dGUoXCJocmVmXCIpO1xuXG5cdFx0cmV0dXJuIGJvb2tVcmw7XG5cdH0gY2F0Y2ggKGVycikge1xuXHRcdGNvbnNvbGUubG9nKGVycik7XG5cdFx0cmV0dXJuIFwiXCI7XG5cdH1cbn07XG5cbi8vIHNlYXJjaCBrZXl3b3JkIGFuZCByZXR1cm4geWVzMjQgc2VhcmNoIHJlc3VsdCBmcm9tIFx1RDFCNVx1RDU2OVx1QUM4MFx1QzBDOVxuY29uc3QgdG90YWxTZWFyY2hCb29rVXJsID0gYXN5bmMgKGtleXdvcmQ6IHN0cmluZykgPT4ge1xuXHRrZXl3b3JkID0gZW5jb2RlVVJJKGtleXdvcmQpO1xuXHR0cnkge1xuXHRcdGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgcmVxdWVzdFVybCh7XG5cdFx0XHR1cmw6XG5cdFx0XHRcdFwiaHR0cDovL3d3dy55ZXMyNC5jb20vUHJvZHVjdC9TZWFyY2g/ZG9tYWluPUFMTCZxdWVyeT1cIiArXG5cdFx0XHRcdGtleXdvcmQsXG5cdFx0fSk7XG5cblx0XHRjb25zdCBwYXJzZXIgPSBuZXcgRE9NUGFyc2VyKCk7XG5cdFx0Y29uc3QgaHRtbCA9IHBhcnNlci5wYXJzZUZyb21TdHJpbmcocmVzcG9uc2UudGV4dCwgXCJ0ZXh0L2h0bWxcIik7XG5cblx0XHRjb25zdCBib29rVXJsID0gaHRtbFxuXHRcdFx0LnF1ZXJ5U2VsZWN0b3IoXG5cdFx0XHRcdFwiI3llc1NjaExpc3QgPiBsaTpudGgtY2hpbGQoMSkgPiBkaXYgPiBkaXYuaXRlbV9pbmZvID4gZGl2LmluZm9fcm93LmluZm9fbmFtZSA+IGEuZ2RfbmFtZVwiXG5cdFx0XHQpXG5cdFx0XHQuZ2V0QXR0cmlidXRlKFwiaHJlZlwiKTtcblxuXHRcdHJldHVybiBib29rVXJsO1xuXHR9IGNhdGNoIChlcnIpIHtcblx0XHRjb25zb2xlLmxvZyhlcnIpO1xuXHRcdHJldHVybiBcIlwiO1xuXHR9XG59O1xuXG4vLyBnZXQgYm9vayB1cmxcbi8vIGlmIG5vdCBzZWFyY2hlZCBpbiBcdUFENkRcdUIwQjRcdUIzQzRcdUMxMUMsIHJlc2VhcmNoIGF0IFx1RDFCNVx1RDU2OVx1QUM4MFx1QzBDOSBhbmQgcmV0dXJuIHVybFxuY29uc3QgZ2V0Qm9va1VybCA9IGFzeW5jIChrZXl3b3JkOiBzdHJpbmcpID0+IHtcblx0bGV0IGJvb2tVcmwgPSBhd2FpdCBzZWFyY2hCb29rVXJsKGtleXdvcmQpO1xuXG5cdGlmICghYm9va1VybCkgYm9va1VybCA9IGF3YWl0IHRvdGFsU2VhcmNoQm9va1VybChrZXl3b3JkKTtcblxuXHRyZXR1cm4gYm9va1VybDtcbn07XG5cbi8vIGdvdG8gYm9vayBpbmZvXG4vLyBpZiBib29rIGhhcyBzdWIgdGl0bGUsIHRpdGxlIHdpbGwgYmUgbWVyZ2VkXG4vLyBpZiBwYWdlIGlzIG5vdCBudW1iZXIsIGNvbnZlcnQgaW50byAwXG5jb25zdCBnZXRCb29rSW5mb1Jlc3VsdCA9IGFzeW5jIChib29rVXJsOiBzdHJpbmcpID0+IHtcblx0Ym9va1VybCA9IGVuY29kZVVSSShib29rVXJsKTtcblx0dHJ5IHtcblx0XHRjb25zdCByZXNwb25zZSA9IGF3YWl0IHJlcXVlc3RVcmwoe1xuXHRcdFx0dXJsOiBgaHR0cDovL3d3dy55ZXMyNC5jb21gICsgYm9va1VybCxcblx0XHR9KTtcblxuXHRcdGNvbnN0IHBhcnNlciA9IG5ldyBET01QYXJzZXIoKTtcblx0XHRjb25zdCBodG1sID0gcGFyc2VyLnBhcnNlRnJvbVN0cmluZyhyZXNwb25zZS50ZXh0LCBcInRleHQvaHRtbFwiKTtcblxuXHRcdGNvbnN0IHRhZ3M6IHN0cmluZ1tdID0gW107XG5cblx0XHRodG1sLnF1ZXJ5U2VsZWN0b3JBbGwoXG5cdFx0XHRcIiNpbmZvc2V0X2dvb2RzQ2F0ZSA+IGRpdi5pbmZvU2V0Q29udF93cmFwID4gZGw6bnRoLWNoaWxkKDEpID4gZGQgPiB1bCA+IGxpID4gYVwiXG5cdFx0KS5mb3JFYWNoKCh2YWx1ZSkgPT4ge1xuXHRcdFx0dGFncy5wdXNoKHZhbHVlLmdldFRleHQoKS5yZXBsYWNlKC8oXFxzKikvZywgXCJcIikpO1xuXHRcdH0pO1xuXG5cdFx0Y29uc3QgdGFnID0gWy4uLm5ldyBTZXQodGFncyldO1xuXG5cdFx0bGV0IHRpdGxlID0gaHRtbFxuXHRcdFx0LnF1ZXJ5U2VsZWN0b3IoXG5cdFx0XHRcdFwiI3lEZXRhaWxUb3BXcmFwID4gZGl2LnRvcENvbFJndCA+IGRpdi5nZF9pbmZvVG9wID4gZGl2ID4gaDJcIlxuXHRcdFx0KVxuXHRcdFx0LmdldFRleHQoKVxuXHRcdFx0LnJlcGxhY2UoL1xcKC4qXFwpL2dpLCBcIlwiKVxuXHRcdFx0LnJlcGxhY2UoL1xcWy4qXFxdL2dpLCBcIlwiKVxuXHRcdFx0LnJlcGxhY2UoXCI6XCIsIFwiXHVGRjFBXCIpXG5cdFx0XHQucmVwbGFjZShcIj9cIiwgXCJcdUZGMUZcIilcblx0XHRcdC50cmltKCk7XG5cblx0XHRsZXQgc3ViVGl0bGUgPSBodG1sLnF1ZXJ5U2VsZWN0b3IoXG5cdFx0XHRcIiN5RGV0YWlsVG9wV3JhcCA+IGRpdi50b3BDb2xSZ3QgPiBkaXYuZ2RfaW5mb1RvcCA+IGRpdiA+IGgzXCJcblx0XHQpO1xuXG5cdFx0aWYgKHN1YlRpdGxlKSB7XG5cdFx0XHR0aXRsZSA9XG5cdFx0XHRcdHRpdGxlICtcblx0XHRcdFx0XCJcdUZGMUFcIiArXG5cdFx0XHRcdHN1YlRpdGxlLmdldFRleHQoKS5yZXBsYWNlKFwiOlwiLCBcIlx1RkYxQVwiKS5yZXBsYWNlKFwiP1wiLCBcIlx1RkYxRlwiKS50cmltKCk7XG5cdFx0fVxuXG5cdFx0Y29uc3QgYXV0aG9yOiBzdHJpbmdbXSA9IFtdO1xuXG5cdFx0aHRtbC5xdWVyeVNlbGVjdG9yQWxsKFxuXHRcdFx0XCIjeURldGFpbFRvcFdyYXAgPiBkaXYudG9wQ29sUmd0ID4gZGl2LmdkX2luZm9Ub3AgPiBzcGFuLmdkX3B1YkFyZWEgPiBzcGFuLmdkX2F1dGhcIlxuXHRcdCkuZm9yRWFjaCgodmFsdWUpID0+IHtcblx0XHRcdGF1dGhvci5wdXNoKHZhbHVlLmdldFRleHQoKS50cmltKCkpO1xuXHRcdH0pO1xuXG5cdFx0bGV0IHBhZ2UgPSAraHRtbFxuXHRcdFx0LnF1ZXJ5U2VsZWN0b3IoXG5cdFx0XHRcdFwiI2luZm9zZXRfc3BlY2lmaWMgPiBkaXYuaW5mb1NldENvbnRfd3JhcCA+IGRpdiA+IHRhYmxlID4gdGJvZHkgPiB0cjpudGgtY2hpbGQoMikgPiB0ZFwiXG5cdFx0XHQpXG5cdFx0XHQuZ2V0VGV4dCgpXG5cdFx0XHQuc3BsaXQoXCIgXCIpWzBdXG5cdFx0XHQuc2xpY2UoMCwgLTEpO1xuXG5cdFx0aWYgKGlzTmFOKHBhZ2UpKSBwYWdlID0gMDtcblxuXHRcdGNvbnN0IHB1Ymxpc2hEYXRlID0gaHRtbFxuXHRcdFx0LnF1ZXJ5U2VsZWN0b3IoXG5cdFx0XHRcdFwiI3lEZXRhaWxUb3BXcmFwID4gZGl2LnRvcENvbFJndCA+IGRpdi5nZF9pbmZvVG9wID4gc3Bhbi5nZF9wdWJBcmVhID4gc3Bhbi5nZF9kYXRlXCJcblx0XHRcdClcblx0XHRcdC5nZXRUZXh0KClcblx0XHRcdC5zcGxpdChcIiBcIilcblx0XHRcdC5tYXAoKHYpID0+IHYuc2xpY2UoMCwgLTEpKVxuXHRcdFx0LmpvaW4oXCItXCIpO1xuXG5cdFx0Y29uc3QgY292ZXJVcmwgPSBodG1sXG5cdFx0XHQucXVlcnlTZWxlY3Rvcihcblx0XHRcdFx0XCIjeURldGFpbFRvcFdyYXAgPiBkaXYudG9wQ29sTGZ0ID4gZGl2ID4gc3BhbiA+IGVtID4gaW1nXCJcblx0XHRcdClcblx0XHRcdC5nZXRBdHRyaWJ1dGUoXCJzcmNcIik7XG5cblx0XHRjb25zdCBmcm9udG1hdHRlciA9IHtcblx0XHRcdGNyZWF0ZWQ6IGAke1xuXHRcdFx0XHRuZXcgRGF0ZSgrbmV3IERhdGUoKSArIDMyNDAgKiAxMDAwMClcblx0XHRcdFx0XHQudG9JU09TdHJpbmcoKVxuXHRcdFx0XHRcdC5zcGxpdChcIlRcIilbMF0gK1xuXHRcdFx0XHRcIiBcIiArXG5cdFx0XHRcdG5ldyBEYXRlKCkudG9UaW1lU3RyaW5nKCkuc3BsaXQoXCIgXCIpWzBdLnNsaWNlKDAsIDUpXG5cdFx0XHR9YCxcblx0XHRcdHRhZzogYFx1RDgzRFx1RENEQVx1QjNDNVx1QzExQyAke3RhZy5qb2luKFwiIFwiKX1gLFxuXHRcdFx0dGl0bGU6IGAke3RpdGxlfWAsXG5cdFx0XHRhdXRob3I6IGAke2F1dGhvci5qb2luKFwiLCBcIil9YCxcblx0XHRcdGNhdGVnb3J5OiBgJHt0YWdbMV19YCxcblx0XHRcdHRvdGFsX3BhZ2U6IHBhZ2UsXG5cdFx0XHRwdWJsaXNoX2RhdGU6IGAke3B1Ymxpc2hEYXRlfWAsXG5cdFx0XHRjb3Zlcl91cmw6IGAke2NvdmVyVXJsfWAsXG5cdFx0XHRzdGF0dXM6IGBcdUQ4M0RcdURGRTkgXHVDNjQ0XHVCOENDYCxcblx0XHRcdHN0YXJ0X3JlYWRfZGF0ZTogYCR7XG5cdFx0XHRcdG5ldyBEYXRlKCtuZXcgRGF0ZSgpICsgMzI0MCAqIDEwMDAwKS50b0lTT1N0cmluZygpLnNwbGl0KFwiVFwiKVswXVxuXHRcdFx0fWAsXG5cdFx0XHRmaW5pc2hfcmVhZF9kYXRlOiBgJHtcblx0XHRcdFx0bmV3IERhdGUoK25ldyBEYXRlKCkgKyAzMjQwICogMTAwMDApLnRvSVNPU3RyaW5nKCkuc3BsaXQoXCJUXCIpWzBdXG5cdFx0XHR9YCxcblx0XHRcdG15X3JhdGU6IDAsXG5cdFx0XHRib29rX25vdGU6IGBcdTI3NENgLFxuXHRcdH07XG5cblx0XHRjb25zdCByZXN1bHQgPSBgLS0tXG4ke3N0cmluZ2lmeVlhbWwoZnJvbnRtYXR0ZXIpfS0tLVxuXG4jICR7dGl0bGV9YDtcblxuXHRcdHJldHVybiBbXG5cdFx0XHR0aXRsZVxuXHRcdFx0XHQucmVwbGFjZShcIlx1RkYxQVwiLCBcIiBcIilcblx0XHRcdFx0LnJlcGxhY2UoXCJcdUZGMUZcIiwgXCJcIilcblx0XHRcdFx0LnJlcGxhY2UoXCIvXCIsIFwiXHVGRjBGXCIpXG5cdFx0XHRcdC5yZXBsYWNlKC9cXHN7Mix9L2dpLCBcIiBcIiksXG5cdFx0XHRyZXN1bHQsXG5cdFx0XTtcblx0fSBjYXRjaCAoZXJyKSB7XG5cdFx0Y29uc29sZS5sb2coZXJyKTtcblx0XHRyZXR1cm4gW1wiXCIsIFwiXCJdO1xuXHR9XG59O1xuXG4vLyBnZXQgYm9vaydzIGluZm8gYW5kIHJldHVybiBmcm9udG1hdHRlclxuY29uc3QgZ2V0Qm9vayA9IGFzeW5jIChrZXl3b3JkOiBzdHJpbmcpID0+IHtcblx0Y29uc3QgYm9va1VybCA9IGF3YWl0IGdldEJvb2tVcmwoa2V5d29yZCk7XG5cblx0aWYgKCFib29rVXJsKSB7XG5cdFx0cmV0dXJuIFtrZXl3b3JkLCBgJHtrZXl3b3JkfSBObyB0aXRsZSBmb3VuZGBdO1xuXHR9XG5cblx0Y29uc3QgW3RpdGxlLCByZXN1bHRdID0gYXdhaXQgZ2V0Qm9va0luZm9SZXN1bHQoYm9va1VybCk7XG5cblx0aWYgKCFyZXN1bHQpIHtcblx0XHRyZXR1cm4gW2tleXdvcmQsIGAke2tleXdvcmR9IE5vIHRpdGxlIGZvdW5kYF07XG5cdH1cblxuXHRyZXR1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
